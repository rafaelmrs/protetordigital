---
// ToolLayout.astro — Shared layout component for all tool pages
interface Props {
  toolNum: string;
  title: string;
  description: string;
  accentColor: string;
  accentVar: string;
  badgeClass: string;
  icon: string;
  breadcrumb: string;
  tips: string[];
  tipAccent: string;
  tipsTitle: string;
  lgpdNote?: string;
}

const {
  toolNum,
  title,
  description,
  accentColor,
  accentVar,
  badgeClass,
  icon,
  breadcrumb,
  tips,
  tipAccent,
  tipsTitle,
  lgpdNote,
} = Astro.props;

const ADSENSE_ID = import.meta.env.PUBLIC_ADSENSE_ID;

// Other tools data (excluding current)
const allTools = [
  { href: '/tools/senha', label: 'Verificação de Senhas', sub: 'Sua senha é suficientemente forte?', color: 'var(--blue)', bg: 'rgba(59,130,246,0.08)', border: 'rgba(59,130,246,0.2)', icon: `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>` },
  { href: '/tools/link', label: 'Checagem de Links', sub: 'Detecte links perigosos antes de clicar', color: 'var(--cyan)', bg: 'rgba(6,182,212,0.08)', border: 'rgba(6,182,212,0.2)', icon: `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>` },
  { href: '/tools/vazamento', label: 'Busca de Vazamentos', sub: 'Seu e-mail apareceu em algum vazamento?', color: 'var(--amber)', bg: 'rgba(245,158,11,0.08)', border: 'rgba(245,158,11,0.2)', icon: `<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/></svg>` },
];

const currentPath = Astro.url.pathname;
const otherTools = allTools.filter(t => t.href !== currentPath);
---

<div class="container" style="padding-top:32px;padding-bottom:80px;">

  <!-- Breadcrumb -->
  <nav aria-label="Localização na página" style="margin-bottom:28px;">
    <ol class="breadcrumb">
      <li><a href="/">início</a></li>
      <li class="breadcrumb-sep" aria-hidden="true">/</li>
      <li style="color:var(--text-2);">{breadcrumb}</li>
    </ol>
  </nav>

  <!-- Page header -->
  <header style="margin-bottom:36px;">

    <h1 style="font-family:var(--font-body);font-size:clamp(1.7rem,4vw,2.2rem);font-weight:800;color:var(--text);letter-spacing:-0.04em;margin-bottom:12px;">{title}</h1>
    <p style="font-size:15px;color:var(--text-2);max-width:560px;line-height:1.7;">{description}</p>
  </header>

  <!-- Tool + Sidebar layout -->
  <div style="display:grid;grid-template-columns:1fr;gap:24px;" id="tool-grid">

    <!-- Tool slot -->
    <div id="tool-main">
      <slot />
    </div>

    <!-- Sidebar -->
    <aside id="tool-sidebar" style="display:flex;flex-direction:column;gap:16px;">

      <!-- AdSense Sidebar -->
      {ADSENSE_ID && (
        <div style="min-height:280px;" id="adsense-sidebar-wrap">
          <ins class="adsbygoogle" style="display:block;width:300px;height:600px;max-width:100%;" data-ad-client={ADSENSE_ID} data-ad-slot="TOOL_SIDEBAR_SLOT" data-ad-format="rectangle"></ins>
          <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
      )}

      <!-- Tips card -->
      <div class="card" style={`padding:22px;${accentColor !== 'var(--blue)' ? `border-color:${accentColor}28;` : ''}`}>
        <h2 style="font-family:var(--font-body);font-size:13px;font-weight:700;color:var(--text);margin-bottom:16px;letter-spacing:-0.01em;">{tipsTitle}</h2>
        <div style="display:flex;flex-direction:column;">
          {tips.map((tip, i) => (
            <p style={`font-size:13px;color:var(--text-2);padding:10px 0;line-height:1.6;display:flex;align-items:baseline;gap:8px;${i < tips.length - 1 ? 'border-bottom:1px solid var(--border);' : ''}`}>
              <span style={`color:${tipAccent};font-family:var(--font-mono);font-size:11px;flex-shrink:0;`} aria-hidden="true">→</span>
              {tip}
            </p>
          ))}
        </div>
        {lgpdNote && (
          <a href="https://www.gov.br/anpd/reclamacoes" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm btn-full" style="margin-top:16px;justify-content:center;">
            {lgpdNote}
          </a>
        )}
      </div>

      <!-- Other tools -->
      <div class="card" style="padding:22px;">
        <h2 style="font-family:var(--font-body);font-size:13px;font-weight:700;color:var(--text);margin-bottom:14px;">Outras ferramentas</h2>
        <div style="display:flex;flex-direction:column;gap:8px;">
          {otherTools.map(tool => (
            <a href={tool.href} class="card card-hover" style="padding:12px;text-decoration:none;display:flex;align-items:center;gap:10px;">
              <div style={`width:32px;height:32px;background:${tool.bg};border:1px solid ${tool.border};border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;color:${tool.color};flex-shrink:0;`} set:html={tool.icon}></div>
              <div>
                <p style="font-size:13px;font-weight:600;color:var(--text);margin-bottom:2px;">{tool.label}</p>
                <p style="font-size:12px;color:var(--text-3);">{tool.sub}</p>
              </div>
            </a>
          ))}
        </div>
      </div>

      <!-- Share (sidebar — visible on desktop) -->
      <div class="card tool-share-sidebar" style="padding:22px;">
        <h2 style="font-family:var(--font-body);font-size:13px;font-weight:700;color:var(--text);margin-bottom:14px;">Compartilhar</h2>
        <div style="display:flex;flex-direction:column;gap:7px;">
          <a id="share-wa-sidebar" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-wa-btn" style="gap:7px;justify-content:center;" aria-label="Compartilhar no WhatsApp">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.136.561 4.14 1.535 5.872L0 24l6.27-1.512A11.95 11.95 0 0 0 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.887 0-3.649-.511-5.165-1.4L3 22l1.45-4.738A10 10 0 0 1 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>
            WhatsApp
          </a>
          <a id="share-fb-sidebar" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-fb-btn" style="gap:7px;justify-content:center;" aria-label="Compartilhar no Facebook">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            Facebook
          </a>
          <a id="share-x-sidebar" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-x-btn" style="gap:7px;justify-content:center;" aria-label="Compartilhar no X">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.748l7.73-8.835L2.032 2.25H9.05l4.26 5.632 4.934-5.632zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
          </a>
          <button id="share-copy-sidebar" onclick="navigator.clipboard.writeText(window.location.href).then(()=>{const t=this;t.querySelector('span').textContent='Copiado!';setTimeout(()=>{t.querySelector('span').textContent='Copiar link'},2000)})" class="btn btn-outline btn-sm" style="gap:7px;justify-content:center;" aria-label="Copiar link">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
            <span>Copiar link</span>
          </button>
        </div>
      </div>

    </aside>
  </div>

  <!-- Share (mobile — below main tool) -->
  <div class="card tool-share-mobile" style="padding:22px;margin-top:16px;">
    <h2 style="font-family:var(--font-body);font-size:13px;font-weight:700;color:var(--text);margin-bottom:14px;">Compartilhar</h2>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
      <a id="share-wa-mobile" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-wa-btn" style="gap:6px;justify-content:center;" aria-label="Compartilhar no WhatsApp">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M12 0C5.373 0 0 5.373 0 12c0 2.136.561 4.14 1.535 5.872L0 24l6.27-1.512A11.95 11.95 0 0 0 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 22c-1.887 0-3.649-.511-5.165-1.4L3 22l1.45-4.738A10 10 0 0 1 2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10z"/></svg>
        WhatsApp
      </a>
      <a id="share-fb-mobile" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-fb-btn" style="gap:6px;justify-content:center;" aria-label="Compartilhar no Facebook">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
        Facebook
      </a>
      <a id="share-x-mobile" href="#" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-sm tool-share-x-btn" style="gap:6px;justify-content:center;" aria-label="Compartilhar no X">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.748l7.73-8.835L2.032 2.25H9.05l4.26 5.632 4.934-5.632zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
      </a>
      <button id="share-copy-mobile" onclick="navigator.clipboard.writeText(window.location.href).then(()=>{const t=this;t.querySelector('span').textContent='Copiado!';setTimeout(()=>{t.querySelector('span').textContent='Copiar link'},2000)})" class="btn btn-outline btn-sm" style="gap:6px;justify-content:center;" aria-label="Copiar link">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>
        <span>Copiar link</span>
      </button>
    </div>
  </div>
</div>

<style>
  @media (min-width: 1024px) {
    #tool-grid { grid-template-columns: 1fr 320px !important; }
    .tool-share-mobile { display: none !important; }
  }
  @media (max-width: 1023px) {
    .tool-share-sidebar { display: none !important; }
  }
  .tool-share-x-btn {
    min-height: 34px;
  }
  .tool-share-wa-btn:hover {
    background: #25D366 !important;
    border-color: #25D366 !important;
    color: #fff !important;
  }
  .tool-share-fb-btn:hover {
    background: #1877F2 !important;
    border-color: #1877F2 !important;
    color: #fff !important;
  }
  .tool-share-x-btn:hover {
    background: #000 !important;
    border-color: #000 !important;
    color: #fff !important;
  }
</style>

<script>
  const url = window.location.href;
  const title = document.title;

  document.querySelectorAll('#share-wa-sidebar, #share-wa-mobile').forEach(el => {
    el.href = 'https://wa.me/?text=' + encodeURIComponent(title + ' ' + url);
  });
  document.querySelectorAll('#share-fb-sidebar, #share-fb-mobile').forEach(el => {
    el.href = 'https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url);
  });
  document.querySelectorAll('#share-x-sidebar, #share-x-mobile').forEach(el => {
    el.href = 'https://x.com/intent/tweet?text=' + encodeURIComponent(title) + '&url=' + encodeURIComponent(url);
  });
</script>
